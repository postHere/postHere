use posthere;

-- 유저추가
INSERT INTO user_info ( login_pw, email, nickname, profile_photo_url, created_at, updated_at) VALUES
( '$2a$10$4NvPcqispQgwWRJaHFAUKeHV1d6bhItvO8y1RMOWGdZIx5R24WBtS', 'frostbeam812@gmail.com',  'hello.minji',   'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/profile/profile1.jpg',  NOW(), NOW()),
( '$2a$10$4NvPcqispQgwWRJaHFAUKeHV1d6bhItvO8y1RMOWGdZIx5R24WBtS', 'skybridge92@gmail.com',  '_daily_seul',   'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/profile/profile2.jpg',  NOW(), NOW()),
( '$2a$10$4NvPcqispQgwWRJaHFAUKeHV1d6bhItvO8y1RMOWGdZIx5R24WBtS', 'pixelrook13@gmail.com',  'jjin_e',   'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/profile/profile3.jpg',  NOW(), NOW()),
( '$2a$10$4NvPcqispQgwWRJaHFAUKeHV1d6bhItvO8y1RMOWGdZIx5R24WBtS', 'riverstone.dev@gmail.com',  'mango_babe',   'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/profile/profile4.jpg',  NOW(), NOW()),
( '$2a$10$4NvPcqispQgwWRJaHFAUKeHV1d6bhItvO8y1RMOWGdZIx5R24WBtS', 'limeghost07@gmail.com',  'our_bin',   'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/profile/profile5.jpg',  NOW(), NOW()),
( '$2a$10$4NvPcqispQgwWRJaHFAUKeHV1d6bhItvO8y1RMOWGdZIx5R24WBtS', 'cobalt.echo9@gmail.com',  'go.eun',   'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/profile/profile6.jpg',  NOW(), NOW()),
('$2a$10$4NvPcqispQgwWRJaHFAUKeHV1d6bhItvO8y1RMOWGdZIx5R24WBtS', 'nightbamboo24@gmail.com',  'sunshine_yun',   'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/profile/profile7.png',  NOW(), NOW()),
( '$2a$10$4NvPcqispQgwWRJaHFAUKeHV1d6bhItvO8y1RMOWGdZIx5R24WBtS', 'cloudbyte77@gmail.com',  'dear.you_',   'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/profile/profile8.png',  NOW(), NOW()),
( '$2a$10$4NvPcqispQgwWRJaHFAUKeHV1d6bhItvO8y1RMOWGdZIx5R24WBtS', 'sunnydock04@naver.com', 'hee_story',   'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/profile/profile9.jpg', NOW(), NOW()),
('$2a$10$4NvPcqispQgwWRJaHFAUKeHV1d6bhItvO8y1RMOWGdZIx5R24WBtS', 'echo.wave35@naver.com', 'wooju.ss', 'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/profile/profile10.jpg', NOW(), NOW()),
('$2a$10$4NvPcqispQgwWRJaHFAUKeHV1d6bhItvO8y1RMOWGdZIx5R24WBtS', 'pinegradle@naver.com', 'bright_chae', 'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/profile/profile11.png', NOW(), NOW()),
( '$2a$10$4NvPcqispQgwWRJaHFAUKeHV1d6bhItvO8y1RMOWGdZIx5R24WBtS', 'bluegrain93@naver.com', 'sky_haneul', 'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/profile-images/profile12.jpg', NOW(), NOW()),
('$2a$10$4NvPcqispQgwWRJaHFAUKeHV1d6bhItvO8y1RMOWGdZIx5R24WBtS', 'tinyorbit12@naver.com', 'little_forest_rim', 'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/profile-images/profile13.jpg', NOW(), NOW()),
('$2a$10$4NvPcqispQgwWRJaHFAUKeHV1d6bhItvO8y1RMOWGdZIx5R24WBtS', 'moss_bridge@naver.com', 'ocean_blue_min', 'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/profile-images/profile14.webp', NOW(), NOW()),
('$2a$10$4NvPcqispQgwWRJaHFAUKeHV1d6bhItvO8y1RMOWGdZIx5R24WBtS', 'kitepark58@naver.com', 'jiyoung.mood', 'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/profile-images/profile15.jpg', NOW(), NOW()),
( '$2a$10$4NvPcqispQgwWRJaHFAUKeHV1d6bhItvO8y1RMOWGdZIx5R24WBtS', 'neonriver46@daum.net', 'minjun.vibes', 'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/profile-images/profile16.jpg', NOW(), NOW()),
('$2a$10$4NvPcqispQgwWRJaHFAUKeHV1d6bhItvO8y1RMOWGdZIx5R24WBtS', 'mintdriver02@daum.net', 'eunwoo_daily', 'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/profile-images/profile17.jpg', NOW(), NOW()),
( '$2a$10$4NvPcqispQgwWRJaHFAUKeHV1d6bhItvO8y1RMOWGdZIx5R24WBtS', 'maple_ring19@daum.net', 'hayoon.dream', 'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/profile-images/profile18.jpg', NOW(), NOW()),
( '$2a$10$4NvPcqispQgwWRJaHFAUKeHV1d6bhItvO8y1RMOWGdZIx5R24WBtS', 'nanun_solo@daum.net', 'im_solo','https://posthere-s3.s3.ap-northeast-2.amazonaws.com/profile-images/1760613670.png', NOW(), NOW());


INSERT INTO park(owner_id, content_capture_url, updated_at) VALUES
(1, 'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/default_park.PNG', now()),
(2, 'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/default_park.PNG', now()),
(3, 'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/default_park.PNG', now()),
(4, 'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/default_park.PNG', now()),
(5, 'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/default_park.PNG', now()),
(6, 'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/default_park.PNG', now()),
(7, 'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/default_park.PNG', now()),
(8, 'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/default_park.PNG', now()),
(9, 'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/default_park.PNG', now()),
(10, 'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/default_park.PNG', now()),
(11, 'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/default_park.PNG', now()),
(12, 'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/default_park.PNG', now()),
(13, 'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/default_park.PNG', now()),
(14, 'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/default_park.PNG', now()),
(15, 'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/default_park.PNG', now()),
(16, 'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/default_park.PNG', now()),
(17, 'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/default_park.PNG', now()),
(18, 'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/default_park.PNG', now()),
(19, 'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/default_park.PNG', now());


-- DELIMITER는 프로시저 정의가 끝나는 지점을 알려주기 위해 사용합니다.
DELIMITER $$

CREATE PROCEDURE GenerateFollowers()
BEGIN
    -- 변수 선언
    DECLARE done INT DEFAULT FALSE; -- 루프 종료를 위한 플래그
    DECLARE v_followed_id BIGINT UNSIGNED; -- 팔로우 당할 유저의 ID를 저장할 변수


DELIMITER $$

CREATE PROCEDURE GenerateFollowers()
BEGIN
    -- 변수 선언
    DECLARE done INT DEFAULT FALSE;
    DECLARE v_followed_id BIGINT UNSIGNED;
    DECLARE v_limit INT; -- 랜덤 팔로워 수를 저장할 변수 추가

    -- 팔로우 대상이 될 테스트 유저 목록을 반복 처리하기 위한 커서(CURSOR) 정의
    DECLARE cur_followed CURSOR FOR
        SELECT user_info_pk FROM user_info
        WHERE email IN (
            'frostbeam812@gmail.com', 'skybridge92@gmail.com', 'pixelrook13@gmail.com',
            'riverstone.dev@gmail.com', 'limeghost07@gmail.com', 'cobalt.echo9@gmail.com',
            'nightbamboo24@gmail.com', 'cloudbyte77@gmail.com', 'sunnydock04@naver.com',
            'echo.wave35@naver.com', 'pinegradle@naver.com', 'bluegrain93@naver.com',
            'tinyorbit12@naver.com', 'moss_bridge@naver.com', 'kitepark58@naver.com',
            'neonriver46@daum.net', 'mintdriver02@daum.net', 'maple_ring19@daum.net',
            'nanun_solo@daum.net'
        );

    -- 커서의 마지막에 도달하면 done 변수를 TRUE로 설정
    DECLARE CONTINUE HANDLER FOR NOT FOUND SET done = TRUE;

    -- 커서 열기
    OPEN cur_followed;

    -- 루프 시작
    read_loop: LOOP
        -- 커서에서 다음 유저 ID를 가져와 v_followed_id에 저장
        FETCH cur_followed INTO v_followed_id;

        -- 더 이상 가져올 유저가 없으면 루프 종료
        IF done THEN
            LEAVE read_loop;
        END IF;

        -- *** 수정된 부분 1: INSERT 전에 랜덤 숫자 계산 ***
        SET v_limit = FLOOR(RAND() * 4) + 7; -- 7~10 사이의 숫자를 변수에 저장

        -- follower_id와 followed_id를 following 테이블에 삽입
        INSERT IGNORE INTO following (follower_id, followed_id)
        SELECT
            user_info_pk,
            v_followed_id
        FROM
            user_info
        WHERE
            user_info_pk != v_followed_id
        ORDER BY
            RAND()
        -- *** 수정된 부분 2: LIMIT 절에 변수 사용 ***
        LIMIT v_limit;

    END LOOP;

    -- 커서 닫기
    CLOSE cur_followed;

END$$

DELIMITER ;
CALL GenerateFollowers();

-- 포럼 게시물
INSERT INTO forum (created_at, updated_at, writer_id, contents_text, location) VALUES
(NOW() - INTERVAL 12 DAY, NOW() - INTERVAL 12 DAY + INTERVAL 2 HOUR,
 (SELECT user_info_pk FROM user_info WHERE TRIM(nickname)='hello.minji'),
 '아침 산책하다가 하늘이 너무 예뻐서 한 컷. 오늘도 파이팅!', 7),

(NOW() - INTERVAL 11 DAY, NOW() - INTERVAL 11 DAY + INTERVAL 1 HOUR,
 (SELECT user_info_pk FROM user_info WHERE TRIM(nickname)='_daily_seul'),
 '카페에서 작업 중 집중 잘 되는 자리 득템.', 7),

(NOW() - INTERVAL 11 DAY + INTERVAL 5 HOUR, NOW() - INTERVAL 11 DAY + INTERVAL 6 HOUR,
 (SELECT user_info_pk FROM user_info WHERE TRIM(nickname)='jjin_e'),
 '퇴근길 벚꽃이 벌써 지는 중… 아쉽다', 7),

(NOW() - INTERVAL 10 DAY, NOW() - INTERVAL 10 DAY + INTERVAL 30 MINUTE,
 (SELECT user_info_pk FROM user_info WHERE TRIM(nickname)='mango_babe'),
 '오늘 런치: 간단히 연어포케! 건강한 맛', 7),

(NOW() - INTERVAL 10 DAY + INTERVAL 3 HOUR, NOW() - INTERVAL 10 DAY + INTERVAL 4 HOUR,
 (SELECT user_info_pk FROM user_info WHERE TRIM(nickname)='our_bin'),
 '헬스 3일차. 스쿼트가 아직도 제일 어려움…', 7),

(NOW() - INTERVAL 9 DAY, NOW() - INTERVAL 9 DAY + INTERVAL 20 MINUTE,
 (SELECT user_info_pk FROM user_info WHERE TRIM(nickname)='go.eun'),
 '요즘 듣는 플레이리스트 공유합니다', 7),

(NOW() - INTERVAL 9 DAY + INTERVAL 4 HOUR, NOW() - INTERVAL 9 DAY + INTERVAL 5 HOUR,
 (SELECT user_info_pk FROM user_info WHERE TRIM(nickname)='sunshine_yun'),
 '창가에 두었던 몬스테라 새잎이 나왔다', 7),

(NOW() - INTERVAL 8 DAY, NOW() - INTERVAL 8 DAY + INTERVAL 1 HOUR,
 (SELECT user_info_pk FROM user_info WHERE TRIM(nickname)='dear.you_'),
 '작은 성취: 드디어 러닝 5km 완주! 기록은 비밀', 7),

(NOW() - INTERVAL 8 DAY + INTERVAL 6 HOUR, NOW() - INTERVAL 8 DAY + INTERVAL 7 HOUR,
 (SELECT user_info_pk FROM user_info WHERE TRIM(nickname)='hee_story'),
 '독서 모임에서 추천받은 책 시작! 첫 장부터 흡입력 최고.', 7),

(NOW() - INTERVAL 7 DAY, NOW() - INTERVAL 7 DAY + INTERVAL 15 MINUTE,
 (SELECT user_info_pk FROM user_info WHERE TRIM(nickname)='wooju.ss'),
 '동네 빵집 신상 소금빵 대박… 줄 선 이유가 있었네', 7),

(NOW() - INTERVAL 7 DAY + INTERVAL 2 HOUR, NOW() - INTERVAL 7 DAY + INTERVAL 3 HOUR,
 (SELECT user_info_pk FROM user_info WHERE TRIM(nickname)='bright_chae'),
 '미팅 준비로 밤새 PPT 수정… 드디어 끝!', 7),

(NOW() - INTERVAL 6 DAY, NOW() - INTERVAL 6 DAY + INTERVAL 1 HOUR,
 (SELECT user_info_pk FROM user_info WHERE TRIM(nickname)='sky_haneul'),
 '하늘 색이 미쳤다. 비 온 뒤라 그런가 더 맑음', 7),

(NOW() - INTERVAL 6 DAY + INTERVAL 5 HOUR, NOW() - INTERVAL 6 DAY + INTERVAL 6 HOUR,
 (SELECT user_info_pk FROM user_info WHERE TRIM(nickname)='little_forest_rim'),
 '퇴근 후 동네 한 바퀴. 바람이 딱 좋네.', 7),

(NOW() - INTERVAL 5 DAY, NOW() - INTERVAL 5 DAY + INTERVAL 25 MINUTE,
 (SELECT user_info_pk FROM user_info WHERE TRIM(nickname)='ocean_blue_min'),
 '바다 사진 보정해봤는데 색감 만족', 7),

(NOW() - INTERVAL 5 DAY + INTERVAL 4 HOUR, NOW() - INTERVAL 5 DAY + INTERVAL 4 HOUR + INTERVAL 20 MINUTE,
 (SELECT user_info_pk FROM user_info WHERE TRIM(nickname)='jiyoung.mood'),
 '집 정리 DAY. 버릴 것들은 과감히 버리기!', 7),

(NOW() - INTERVAL 4 DAY, NOW() - INTERVAL 4 DAY + INTERVAL 50 MINUTE,
 (SELECT user_info_pk FROM user_info WHERE TRIM(nickname)='minjun.vibes'),
 '새 이어폰 적응 중. 노캔 성능이 꽤 괜찮네.', 7),

(NOW() - INTERVAL 4 DAY + INTERVAL 3 HOUR, NOW() - INTERVAL 4 DAY + INTERVAL 3 HOUR + INTERVAL 10 MINUTE,
 (SELECT user_info_pk FROM user_info WHERE TRIM(nickname)='eunwoo_daily'),
 '오늘도 코딩 공부 2시간. 꾸준함이 답!', 7),

(NOW() - INTERVAL 3 DAY, NOW() - INTERVAL 3 DAY + INTERVAL 1 HOUR,
 (SELECT user_info_pk FROM user_info WHERE TRIM(nickname)='hayoon.dream'),
 '주말 피크닉 계획 중. 돗자리 필수', 7),

(NOW() - INTERVAL 3 DAY + INTERVAL 6 HOUR, NOW() - INTERVAL 3 DAY + INTERVAL 6 HOUR + INTERVAL 30 MINUTE,
 (SELECT user_info_pk FROM user_info WHERE TRIM(nickname)='im_solo'),
 '요즘 최애 라면 조합: 기본+숙주+파 많이', 7),

(NOW() - INTERVAL 2 DAY, NOW() - INTERVAL 2 DAY + INTERVAL 40 MINUTE,
 (SELECT user_info_pk FROM user_info WHERE TRIM(nickname)='hello.minji'),
 '사진 백업하다가 작년 여행 사진 발견! 또 가고 싶다.', 7),

(NOW() - INTERVAL 2 DAY + INTERVAL 2 HOUR, NOW() - INTERVAL 2 DAY + INTERVAL 3 HOUR,
 (SELECT user_info_pk FROM user_info WHERE TRIM(nickname)='_daily_seul'),
 '새 키보드 적응 완료. 타건감이 딱 내 취향.', 7),

(NOW() - INTERVAL 1 DAY + INTERVAL 1 HOUR, NOW() - INTERVAL 1 DAY + INTERVAL 2 HOUR,
 (SELECT user_info_pk FROM user_info WHERE TRIM(nickname)='mango_babe'),
 '저녁 산책길에 본 노을. 설명이 필요 없는 색감.', 7),

(NOW() - INTERVAL 1 DAY + INTERVAL 5 HOUR, NOW() - INTERVAL 1 DAY + INTERVAL 6 HOUR,
 (SELECT user_info_pk FROM user_info WHERE TRIM(nickname)='our_bin'),
 '집에서 홈카페. 라떼아트는 아직도 실패율 90%', 7),

(NOW() - INTERVAL 12 HOUR, NOW() - INTERVAL 11 HOUR,
 (SELECT user_info_pk FROM user_info WHERE TRIM(nickname)='go.eun'),
 '출근길이 상쾌. 오늘 일정도 화이팅!', 7),

(NOW() - INTERVAL 3 HOUR, NOW() - INTERVAL 2 HOUR,
 (SELECT user_info_pk FROM user_info WHERE TRIM(nickname)='sunshine_yun'),
 '간만에 친구 만나 수다 삼매경. 에너지 충전 완료', 7);


insert into forum_img (forum_id, img_url) values
(1, 'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/forum-images/forum1.jpg'),
(2,'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/forum-images/poster.png'),
(3,'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/forum-images/forum2.webp'),
(4,'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/forum-images/forum4.jpg'),
(5,'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/forum-images/forum5.jpg'),
(6,'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/forum-images/forum6.jpg'),
(7,'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/forum-images/forum7.jpg'),
(8,'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/forum-images/forum8.jpg'),
(9,'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/forum-images/forum9.jpg'),
(10,'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/forum-images/forum10.jpg'),
(11,'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/forum-images/forum11.jpg'),
(12,'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/forum-images/forum12.jpg'),
(13,'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/forum-images/forum13.jpg'),
(14, 'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/forum-images/forum14.jpg'),
(15,'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/forum-images/forum15.png'),
(16,'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/forum-images/forum16.jpg'),
(17,'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/forum-images/forum17.png');

-- 포럼 코멘트
INSERT INTO forum_comment (created_at, forum_id, writer_id, contents_text)
SELECT
  TIMESTAMPADD(MINUTE, FLOOR(RAND()*600) + 1, f.created_at) AS created_at,  -- 글 이후 1~600분
  f.forum_pk AS forum_id,
  /* 28~46 중 랜덤 작성자 */
  (
    SELECT w.writer_id FROM (
      SELECT 1 AS writer_id UNION ALL SELECT 2 UNION ALL SELECT 3 UNION ALL SELECT 4 UNION ALL
      SELECT 5 UNION ALL SELECT 6 UNION ALL SELECT 7 UNION ALL SELECT 8 UNION ALL
      SELECT 9 UNION ALL SELECT 10 UNION ALL SELECT 11 UNION ALL SELECT 12 UNION ALL
      SELECT 13 UNION ALL SELECT 14 UNION ALL SELECT 15 UNION ALL SELECT 16 UNION ALL
      SELECT 17 UNION ALL SELECT 18 UNION ALL SELECT 19
    ) AS w
    ORDER BY RAND() LIMIT 1
  ) AS writer_id,
  /* 이모지 없는 댓글 텍스트 풀에서 랜덤 */
  (
    SELECT c.txt FROM (
      SELECT '좋은 글이네요.' AS txt UNION ALL
      SELECT '공유해 주셔서 감사합니다.' UNION ALL
      SELECT '읽고 나서 많은 생각이 들었습니다.' UNION ALL
      SELECT '이런 내용 자주 보고 싶어요.' UNION ALL
      SELECT '표현이 정말 인상 깊었습니다.' UNION ALL
      SELECT '현장감이 느껴집니다.' UNION ALL
      SELECT '덕분에 오늘도 동기부여가 됐어요.' UNION ALL
      SELECT '사진 없이도 장면이 그려지네요.' UNION ALL
      SELECT '비슷한 경험이 있어서 공감했습니다.' UNION ALL
      SELECT '다음 글도 기대하고 있을게요.' UNION ALL
      SELECT '짧지만 임팩트가 있네요.' UNION ALL
      SELECT '정보 정리해 주신 점이 특히 좋았습니다.' UNION ALL
      SELECT '질문이 하나 있는데 댓글로 남깁니다.' UNION ALL
      SELECT '추천해 주신 코스 한 번 가보겠습니다.' UNION ALL
      SELECT '꾸준히 기록하는 모습이 멋져요.' UNION ALL
      SELECT '시간 날 때 자세한 후기 부탁드려요.' UNION ALL
      SELECT '오늘 컨디션이 좋아 보입니다.' UNION ALL
      SELECT '글 구조가 깔끔해서 읽기 편했어요.' UNION ALL
      SELECT '새로운 관점이 인상적이었습니다.' UNION ALL
      SELECT '소소한 일상 공유가 큰 힘이 되네요.' UNION ALL
      SELECT '이런 팁은 많은 분들께 도움이 될 듯해요.' UNION ALL
      SELECT '개인적으로도 시도해 보고 싶습니다.' UNION ALL
      SELECT '내용 덕분에 계획을 세우는 데 도움이 됐어요.' UNION ALL
      SELECT '세부 설명이 친절해서 좋았습니다.' UNION ALL
      SELECT '오랜만에 마음이 편안해졌습니다.' UNION ALL
      SELECT '담백한 문체가 참 좋네요.' UNION ALL
      SELECT '오늘의 하이라이트가 무엇이었는지 궁금합니다.' UNION ALL
      SELECT '짧은 후기라도 계속 남겨주세요.' UNION ALL
      SELECT '진심이 느껴지는 기록이었습니다.' UNION ALL
      SELECT '읽고 나니 오늘이 더 기대됩니다.'
    ) AS c
    ORDER BY RAND() LIMIT 1
  ) AS contents_text
FROM forum f
/* 각 게시글당 5개 생성용 숫자 테이블 */
JOIN (
  SELECT 1 n UNION ALL SELECT 2 UNION ALL SELECT 3 UNION ALL SELECT 4 UNION ALL SELECT 5
) AS nums
WHERE f.forum_pk BETWEEN 1 AND 25;

-- find 게시물
INSERT INTO find (
  `writer_id`,
  `coordinates`,
  `content_capture_url`,
  `created_at`,
  `expiration_date`,
  `content_overwrite_url`
) VALUES

-- 5m 
(1, ST_SRID(POINT(127.0597532, 37.5107072), 4326), 'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/find/37.5107072_127.0597532/find1.jpg', '2025-09-29 10:12:34', '2025-11-03 10:12:34', 
	'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/overwrite/37.5107072_127.0597532/find1.jpg'),
(5, ST_SRID(POINT(127.0598102, 37.5106622), 4326), 'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/find/37.5106622_127.0598102/find2.webp', '2025-09-24 18:39:00', '2025-11-29 18:39:00', 
	'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/overwrite/37.5106622_127.0598102/find2.webp'),

-- 15m (38~42)
(11, ST_SRID(POINT(127.0597532, 37.5105272), 4326), 'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/find/37.5105272_127.0597532/find3.png', '2025-09-24 11:26:48', '2025-11-01 11:26:48', 
	'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/overwrite/37.5105272_127.0597532/find3.png'),
(15, ST_SRID(POINT(127.0595832, 37.5106622), 4326), 'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/find/37.5106622_127.0595832/fins4.jpg', '2025-09-25 06:55:00', '2025-11-01 06:55:00', 
	'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/overwrite/37.5106622_127.0595832/fins4.jpg'),

-- 50~200m (43~46)
(2, ST_SRID(POINT(127.0604322, 37.5112022), 4326), 'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/find/37.5112022_127.0604322/find4.jpg', '2025-09-26 21:05:11', '2025-11-28 21:05:11', 
	'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/overwrite/37.5112022_127.0604322/find4.jpg'),
(3, ST_SRID(POINT(127.0586212, 37.5097622), 4326), 'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/find/37.5097622_127.0586212/find5.jpg', '2025-09-25 08:47:02', '2025-11-02 08:47:02', 
	'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/overwrite/37.5097622_127.0586212/find5.jpg'),
(4, ST_SRID(POINT(127.0597532, 37.5120122), 4326), 'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/find/37.5120122_127.0597532/find6.jpg', '2025-09-27 13:22:45', '2025-11-28 13:22:45', 
	'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/overwrite/37.5120122_127.0597532/find6.jpg'),
(12, ST_SRID(POINT(127.0617912, 37.5106622), 4326), 'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/find/37.5106622_127.0617912/find7.jpg', '2025-09-26 15:37:21', '2025-11-29 15:37:21', 
   'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/overwrite/37.5106622_127.0617912/find7.jpg'),

-- 200m~
(6, ST_SRID(POINT(127.0597532, 37.5079622), 4326), 'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/find/37.5079622_127.0597532/find8.jpg', '2025-09-30 07:55:20', '2025-11-03 07:55:20', 
   'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/overwrite/37.5079622_127.0597532/find8.jpg'),
(7, ST_SRID(POINT(127.0540932, 37.5106622), 4326), 'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/find/37.5106622_127.0540932/find9.png', '2025-09-23 23:10:05', '2025-11-29 23:10:05', 
   'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/overwrite/37.5106622_127.0540932/find9.png'),
(8, ST_SRID(POINT(127.0710732, 37.5196622), 4326), 'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/find/37.5196622_127.0710732/find10.jpg', '2025-09-28 02:14:59', '2025-11-30 02:14:59', 
   'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/overwrite/37.5196622_127.0710732/find10.jpg'),
(9, ST_SRID(POINT(127.0371132, 37.4926622), 4326), 'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/find/37.4926622_127.0371132/find11.jpg', '2025-09-25 19:44:33', '2025-11-29 19:44:33', 
   'https://posthere-s3.s3.ap-northeast-2.amazonaws.com/overwrite/37.4926622_127.0371132/find11.jpg');

-- (10, ST_SRID(POINT(126.923592, 37.556928), 4326), 'https://wimg.kyeongin.com/news/legacy/file/201906/20190613000738119_1.jpg', '2025-09-27 09:01:12', '2025-09-28 09:01:12', ''),
-- (13, ST_SRID(POINT(126.923800, 37.556791), 4326), 'https://media.triple.guide/triple-cms/c_limit,f_auto,h_1024,w_1024/9e354051-177f-4ac4-b639-98f64c4a1f25.jpeg', '2025-09-23 12:03:40', '2025-09-28 12:03:40', ''),
-- (14, ST_SRID(POINT(126.923600, 37.556791), 4326), 'https://rimage.savorjapan.com/svj/image/discover_oishii_japan/2346/article_353180_w640z.jpg', '2025-09-29 22:18:07', '2025-10-01 22:18:07', ''),
;

-- 포럼 좋아요
-- 변수 초기화(행 넘버링용)
SET @curr := 0, @rn := 0;

INSERT IGNORE INTO forum_like (forum_id, forum_liker_id, created_at)
SELECT forum_id, liker_id, created_at
FROM (
  SELECT
    x.forum_id,
    x.liker_id,
    x.created_at,
    x.k,
    @rn := IF(@curr = x.forum_id, @rn + 1, 1) AS rn,
    @curr := x.forum_id
  FROM (
    /* 후보 유저를 무작위로 섞어 포럼별로 나열하고,
       포럼별 필요한 개수 K(3~10)를 미리 생성해 조인 */
    SELECT
      f.forum_pk                AS forum_id,
      u.user_info_pk            AS liker_id,
      -- 지난 7일 내 랜덤 시각
      TIMESTAMPADD(
        MINUTE,
        FLOOR(RAND()*10080),            -- 0~10079분
        NOW() - INTERVAL 7 DAY
      )                         AS created_at,
      k.k                       AS k
    FROM (SELECT forum_pk FROM forum WHERE forum_pk BETWEEN 1 AND 25) f
    JOIN (SELECT user_info_pk FROM user_info WHERE user_info_pk BETWEEN 1 AND 19) u
    JOIN (
      /* 포럼별로 K(3~10) 생성 */
      SELECT forum_pk AS forum_id, FLOOR(3 + RAND()*8) AS k
      FROM forum
      WHERE forum_pk BETWEEN 1 AND 25
    ) k ON k.forum_id = f.forum_pk
    ORDER BY f.forum_pk, RAND()
  ) x
) y
WHERE y.rn <= y.k;   -- 포럼별 상위 K명만 삽입


-- 팔로우 알림 (FOLLOW)
INSERT INTO notification
  (created_at, notification_code, following_id, comment_id, park_id, target_user_id, check_status, message_for_find)
SELECT
  f.created_at,
  'FOLLOW' AS notification_code,
  f.following_pk,          -- ← PK 컬럼명이 다르면 수정 (예: id)
  NULL AS comment_id,
  NULL AS park_id,
  f.followed_id AS target_user_id,
  0    AS check_status,    -- 0=미확인
  NULL AS message_for_find
FROM following f
LEFT JOIN notification n
  ON n.notification_code = 'FOLLOW'
 AND n.following_id     = f.following_pk        -- 이미 알림 있으면 제외
WHERE f.created_at >= NOW() - INTERVAL 14 DAY
  AND n.notification_pk IS NULL;
  
-- 댓글 알림 (COMMENT)
-- 댓글 알림 생성(중복 방지: NOT EXISTS, 날짜 필터 없음)
INSERT INTO notification
  (created_at, notification_code, following_id, comment_id, park_id, target_user_id, check_status, message_for_find)
SELECT
  c.created_at,
  'COMMENT' AS notification_code,
  NULL       AS following_id,
  c.forum_comment_pk AS comment_id,
  NULL       AS park_id,
  f.writer_id AS target_user_id,
  0          AS check_status,
  NULL       AS message_for_find
FROM forum_comment c
JOIN forum f ON f.forum_pk = c.forum_id
WHERE NOT EXISTS (
  SELECT 1
  FROM notification n
  WHERE n.notification_code = 'COMMENT'
    AND n.comment_id = c.forum_comment_pk
);

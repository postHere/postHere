<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <title>Friends</title>

    <!-- [변경] viewport-fit=cover 추가: iOS notch 안전영역 변수 활성화 -->
    <meta content="width=device-width, initial-scale=1, viewport-fit=cover" name="viewport"/>

    <!-- CSRF (null-safe) -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css" rel="stylesheet"/>
    <meta content="" name="_csrf" th:attr="content=${_csrf?.token}"/>
    <meta content="X-CSRF-TOKEN" name="_csrf_header" th:attr="content=${_csrf?.headerName}"/>

    <!-- [유지] index.css (앱 공통 레이아웃) -->
    <link rel="stylesheet" th:href="@{/css/index.css}">
    <!-- [변경] friends.css: safe-area + 헤더/탭 고정 플렉스 레이아웃 -->
    <link rel="stylesheet" th:href="@{/css/friends.css}">
    <link rel="stylesheet" th:href="@{/css/main-nav.css}">
    <link href="/pwa/manifest.json" rel="manifest">
    <script th:src="@{/js/bundle.js}"></script>
</head>
<body id="page-friends">
<div id="app-container">

    <!-- [신규] 상태바(노치) 전용 spacer: 컨텐츠가 상태바와 겹치지 않도록 상단을 '비워두는' 고정 영역 -->
    <div aria-hidden="true" class="statusbar-spacer"></div>

    <!-- [변경] 헤더: 중앙 정렬 + 고정 높이(53px) + 하단 보더. 세 탭에서 동일하게 보이도록 고정 -->
    <header class="header">
        <h1>Friends</h1>
    </header>

    <!-- [변경] 탭 바: 헤더 바로 아래에 고정 배치. 스크롤은 아래 패널만 -->
    <div class="tabs">
        <button class="tab active" data-tab="followers">
            <svg aria-hidden="true" class="icon" fill="currentColor" viewBox="0 0 20 20"
                 xmlns="http://www.w3.org/2000/svg">
                <path d="M10 8a3 3 0 100-6 3 3 0 000 6zM3.465 14.493a1.23 1.23 0 00.41 1.412A9.957 9.957 0 0010 18c2.31 0 4.438-.784 6.131-2.095a1.23 1.23 0 00.41-1.412A9.992 9.992 0 0010 12c-2.31 0-4.438.784-6.131 2.095z"/>
            </svg>
            Follower
        </button>
        <button class="tab" data-tab="followings">
            <svg aria-hidden="true" class="icon" fill="currentColor" viewBox="0 0 20 20"
                 xmlns="http://www.w3.org/2000/svg">
                <path d="M10 8a3 3 0 100-6 3 3 0 000 6zM3.465 14.493a1.23 1.23 0 00.41 1.412A9.957 9.957 0 0010 18c2.31 0 4.438-.784 6.131-2.095a1.23 1.23 0 00.41-1.412A9.992 9.992 0 0010 12c-2.31 0-4.438.784-6.131 2.095z"/>
            </svg>
            Following
        </button>
        <button class="tab" data-tab="search">
            <svg aria-hidden="true" class="icon" fill="currentColor" viewBox="0 0 20 20"
                 xmlns="http://www.w3.org/2000/svg">
                <path clip-rule="evenodd" d="M9 3.5a5.5 5.5 0 100 11 5.5 5.5 0 000-11zM2 9a7 7 0 1112.452 4.391l3.328 3.329a.75.75 0 11-1.06 1.06l-3.329-3.328A7 7 0 012 9z"
                      fill-rule="evenodd"/>
            </svg>
            Search
        </button>
    </div>

    <!-- [변경] 패널 래퍼: 헤더/탭 아래 “남은 높이 전체”를 차지하고 내부 .list만 스크롤 -->
    <main class="panels">
        <section class="panel active" id="panel-followers">
            <div aria-live="polite" class="list" id="list-followers"></div>
            <div class="pager">
                <button id="prev-followers">이전</button>
                <span id="page-followers"></span>
                <button id="next-followers">다음</button>
            </div>
        </section>

        <section class="panel" id="panel-followings">
            <div aria-live="polite" class="list" id="list-followings"></div>
            <div class="pager">
                <button id="prev-followings">이전</button>
                <span id="page-followings"></span>
                <button id="next-followings">다음</button>
            </div>
        </section>

        <section class="panel" id="panel-search">
            <!-- ✅ Enter로 검색되도록 form 래핑 (유지) -->
            <form class="searchbar" id="searchForm">
                <label for="searchInput">닉네임으로 검색</label>
                <input aria-label="닉네임으로 검색" autocomplete="off" id="searchInput" placeholder="닉네임으로 검색" type="text"/>
                <button id="searchBtn" type="submit">검색</button>
            </form>
            <div aria-live="polite" class="list" id="list-search"></div>
            <div class="pager">
                <button id="prev-search">이전</button>
                <span id="page-search"></span>
                <button id="next-search">다음</button>
            </div>
        </section>
    </main>

    <div th:replace="~{fragment/main-nav :: mainNavFragment}"></div>
</div>
</body>
</html>

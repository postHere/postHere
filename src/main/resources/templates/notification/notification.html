<!--템플릿: 알림센터 페이지-->

<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <!-- CSRF 메타: notification.js에서 /notification POST 호출 시 헤더로 첨부 -->
    <!-- [운영 메모] CSRF 메타는 Spring Security 미사용 환경에선 비어 있을 수 있음
         - /js/notification.js의 authHeaders()가 메타 존재 시 자동 첨부, 미존재 시 무시
         - 다중 탭/로그인 만료 상황을 고려해 401 응답시 재로그인 유도 처리 권장 -->
    <meta name="_csrf" th:attr="content=${_csrf?.token}">
    <meta name="_csrf_header" th:attr="content=${_csrf?.headerName}">
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <title>Notification</title>
    <link rel="stylesheet" th:href="@{/css/index.css}">
    <link rel="stylesheet" th:href="@{/css/main.css}">
    <link rel="stylesheet" th:href="@{/css/main-nav.css}">
    <link rel="stylesheet" th:href="@{/css/notification.css}">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">

    <!--
      역할(정확한 명칭)
      - 본 템플릿은 알림센터 UI의 컨테이너이며, 실제 데이터 로딩/읽음/뱃지 갱신은 /js/notification.js가 담당
        · 알림 목록 로딩:        POST /api/notifications/list
        · 읽음 처리(전체/선택):   POST /notification   ← (단일 엔드포인트, suffix 금지)
        · 미읽음 카운트 갱신:    POST /api/notifications/unread-count
        · 알림 행 클릭 이동:     GET  /profile/{nickname}
      - 서비스워커와의 연계(클릭 라우팅)
        · service-worker.js의 'notificationclick'에서 postMessage({type:'NAVIGATE', url})를 보내면
          페이지 측에서 라우팅을 수행(알림 클릭 → 본 페이지로 진입하는 시나리오 포함)

      [SW 연계 주의]
      - 동일 URL 재방문 시 중복 이동 방지: 현재 location.pathname과 동등하면 스크롤/포커스만 조정.
    -->

    <!-- PWA: 앱 메타(아이콘/이름 등). SW 등록은 main-nav.js에서 수행 -->
    <link rel="manifest" th:href="@{/pwa/manifest.json}">

    <!-- 페이지 스크립트: 목록 로딩/읽음 처리/뱃지 갱신 수행 -->
    <script defer th:src="@{/js/bundle.js}"></script>
</head>
<body id="page-notifications">
<!-- 페이지 타이틀(정적) -->
<h2>Notification</h2>

<!-- 알림 목록 컨테이너: notification.js가 innerHTML로 카드 목록 렌더링 -->
<div aria-live="polite" class="list" id="list"></div>

<!-- 페이지 이동(이전/다음): notification.js가 상태(page/last) 갱신 -->
<div class="pager">
    <button id="prev">이전</button>
    <span id="page"></span>
    <button id="next">다음</button>
</div>

<div th:replace="~{fragment/main-nav :: mainNavFragment}"></div>
</body>
</html>

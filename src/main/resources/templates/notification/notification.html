<!--ÌÖúÌîåÎ¶ø: ÏïåÎ¶ºÏÑºÌÑ∞ ÌéòÏù¥ÏßÄ-->

<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <!-- CSRF Î©îÌÉÄ: notification.jsÏóêÏÑú /notification/* POST Ìò∏Ï∂ú Ïãú Ìó§ÎçîÎ°ú Ï≤®Î∂Ä -->
    <!-- [Ïö¥ÏòÅ Î©îÎ™®] CSRF Î©îÌÉÄÎäî Spring Security ÎØ∏ÏÇ¨Ïö© ÌôòÍ≤ΩÏóêÏÑ† ÎπÑÏñ¥ ÏûàÏùÑ Ïàò ÏûàÏùå
         - /js/notification.jsÏùò authHeaders()Í∞Ä Î©îÌÉÄ Ï°¥Ïû¨ Ïãú ÏûêÎèô Ï≤®Î∂Ä, ÎØ∏Ï°¥Ïû¨ Ïãú Î¨¥Ïãú
         - Îã§Ï§ë ÌÉ≠/Î°úÍ∑∏Ïù∏ ÎßåÎ£å ÏÉÅÌô©ÏùÑ Í≥†Î†§Ìï¥ 401 ÏùëÎãµÏãú Ïû¨Î°úÍ∑∏Ïù∏ Ïú†ÎèÑ Ï≤òÎ¶¨ Í∂åÏû• -->
    <meta name="_csrf" th:attr="content=${_csrf?.token}">
    <meta name="_csrf_header" th:attr="content=${_csrf?.headerName}">
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <title>Notification</title>

    <!--
      Ïó≠Ìï†(Ï†ïÌôïÌïú Î™ÖÏπ≠)
      - Î≥∏ ÌÖúÌîåÎ¶øÏùÄ ÏïåÎ¶ºÏÑºÌÑ∞ UIÏùò Ïª®ÌÖåÏù¥ÎÑàÏù¥Î©∞, Ïã§Ï†ú Îç∞Ïù¥ÌÑ∞ Î°úÎî©/ÏùΩÏùå/Î±ÉÏßÄ Í∞±Ïã†ÏùÄ /js/notification.jsÍ∞Ä Îã¥Îãπ
        ¬∑ ÏïåÎ¶º Î™©Î°ù Î°úÎî©:        POST /notification/list
        ¬∑ ÏÑ†ÌÉù ÏïåÎ¶º ÏùΩÏùå Ï≤òÎ¶¨:   POST /notification/read (Î©±Îì±)
        ¬∑ ÎØ∏ÏùΩÏùå Ïπ¥Ïö¥Ìä∏ Í∞±Ïã†:    POST /notification/unread-count (Î∞∞ÏßÄ/Îπ®Í∞ÑÏ†ê)
        ¬∑ ÏïåÎ¶º Ìñâ ÌÅ¥Î¶≠ Ïù¥Îèô:     GET  /profile/:userId
      - ÏÑúÎπÑÏä§ÏõåÏª§ÏôÄÏùò Ïó∞Í≥Ñ(ÌÅ¥Î¶≠ ÎùºÏö∞ÌåÖ)
        ¬∑ service-worker.jsÏùò 'notificationclick'ÏóêÏÑú postMessage({type:'NAVIGATE', url})Î•º Î≥¥ÎÇ¥Î©¥
          ÌéòÏù¥ÏßÄ Ï∏°ÏóêÏÑú ÎùºÏö∞ÌåÖÏùÑ ÏàòÌñâ(ÏïåÎ¶º ÌÅ¥Î¶≠ ‚Üí Î≥∏ ÌéòÏù¥ÏßÄÎ°ú ÏßÑÏûÖÌïòÎäî ÏãúÎÇòÎ¶¨Ïò§ Ìè¨Ìï®)

      [SW Ïó∞Í≥Ñ Ï£ºÏùò]
      - ÎèôÏùº URL Ïû¨Î∞©Î¨∏ Ïãú Ï§ëÎ≥µ Ïù¥Îèô Î∞©ÏßÄ: ÌòÑÏû¨ location.pathnameÍ≥º ÎèôÎì±ÌïòÎ©¥ Ïä§ÌÅ¨Î°§/Ìè¨Ïª§Ïä§Îßå Ï°∞Ï†ï.
    -->

    <style>
        body {
            font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial;
            margin: 16px;
            color: #111827;
        }

        .list {
            border: 1px solid #e5e7eb;
            border-radius: 12px;
            overflow: hidden
        }

        .item {
            display: flex;
            gap: 10px;
            align-items: flex-start;
            padding: 12px 14px;
            border-bottom: 1px solid #e5e7eb;
            cursor: pointer
        }

        .item:last-child {
            border-bottom: none
        }

        .avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
            background: #eee
        }

        .meta {
            flex: 1;
            min-width: 0
        }

        .row1 {
            display: flex;
            gap: 8px;
            align-items: center
        }

        .nick {
            font-weight: 700
        }

        .ago {
            color: #6b7280;
            font-size: 12px
        }

        .text {
            color: #374151;
            font-size: 14px;
            margin-top: 2px
        }

        .dot {
            width: 8px;
            height: 8px;
            background: #ef4444;
            border-radius: 50%;
            margin-top: 16px
        }

        .item.read .dot {
            visibility: hidden
        }

        .pager {
            display: flex;
            gap: 8px;
            align-items: center;
            margin-top: 12px
        }

        .pager button {
            border: 1px solid #e5e7eb;
            border-radius: 10px;
            background: #fff;
            padding: 6px 10px;
            cursor: pointer
        }

        #nav-bell {
            position: fixed;
            right: 18px;
            bottom: 18px;
            font-size: 22px
        }

        #nav-bell .badge {
            display: inline-block;
            width: 8px;
            height: 8px;
            background: #ef4444;
            border-radius: 50%;
            margin-left: 4px;
            vertical-align: top
        }
    </style>

    <!-- PWA: Ïï± Î©îÌÉÄ(ÏïÑÏù¥ÏΩò/Ïù¥Î¶Ñ Îì±). SW Îì±Î°ùÏùÄ main-nav.jsÏóêÏÑú ÏàòÌñâ -->
    <!-- [PWA Î©îÎ™®] manifest.jsonÏùò scope/start_urlÏù¥ service-worker.js Ïä§ÏΩîÌîÑ(/)ÏôÄ Ï†ïÌï©Ìï¥Ïïº
         ÏïåÎ¶º ÏïÑÏù¥ÏΩò/Ïù¥Î¶Ñ/Ïä§ÌîåÎûòÏãúÍ∞Ä ÏùºÍ¥ÄÎêòÍ≤å ÎèôÏûëÌï®. ÏïÑÏù¥ÏΩò Í≤ΩÎ°úÎäî /icons/* Î°ú ÎßûÏ∂§ Í∂åÏû• -->
    <link rel="manifest" th:href="@{/pwa/manifest.json}">
</head>
<body>
<!-- ÌéòÏù¥ÏßÄ ÌÉÄÏù¥ÌãÄ(Ï†ïÏ†Å) -->
<h2>Notification</h2>

<!-- ÏïåÎ¶º Î™©Î°ù Ïª®ÌÖåÏù¥ÎÑà: notification.jsÍ∞Ä innerHTMLÎ°ú Ïπ¥Îìú Î™©Î°ù Î†åÎçîÎßÅ -->
<!-- [Î†åÎçî/Î≥¥Ïïà Î©îÎ™®]
     - /js/notification.jsÎäî ÏÑúÎ≤Ñ ÏùëÎãµ ÌÖçÏä§Ìä∏Î•º innerHTMLÎ°ú ÏÇΩÏûÖÌïòÏßÄ ÎßêÍ≥†
       textContent ÎòêÎäî ÏÜçÏÑ± ÏÑ∏ÌåÖÏúºÎ°ú XSS Î∞©ÏßÄ(ÌäπÌûà actor.nickname, text).
     - ÎπÑÎèôÍ∏∞ Î°úÎî© ÏÉÅÌÉú: skeleton(ÌöåÏÉâ Î∏îÎ°ù) ÎòêÎäî 'Î°úÎî© Ï§ë‚Ä¶' ÌîåÎ†àÏù¥Ïä§ÌôÄÎçî Í∂åÏû•.
     - Îπà Î™©Î°ù: 'ÏÉà ÏïåÎ¶ºÏù¥ ÏóÜÏäµÎãàÎã§' Îπà ÏÉÅÌÉú(aria-live=politeÏôÄ Ï§ëÎ≥µ ÏïåÎ¶º Î∞©ÏßÄ) ÌëúÏãú Í∂åÏû•. -->
<div aria-live="polite" class="list" id="list"></div>

<!-- ÌéòÏù¥ÏßÄ Ïù¥Îèô(Ïù¥Ï†Ñ/Îã§Ïùå): notification.jsÍ∞Ä ÏÉÅÌÉú(page/last) Í∞±Ïã† -->
<!-- [ÌéòÏù¥Ïßï UX Î©îÎ™®]
     - Ï≤´ ÌéòÏù¥ÏßÄ(page===0)ÏóêÏÑúÎäî #prev.disabled Ï≤òÎ¶¨ Î∞è aria-disabled="true" Î∂ÄÏó¨.
     - ÎßàÏßÄÎßâ ÌéòÏù¥ÏßÄ(last===true)ÏóêÏÑúÎäî #next.disabled Ï≤òÎ¶¨ Î∞è aria-disabled="true".
     - ÌòÑÏû¨ ÌéòÏù¥ÏßÄ Î≤àÌò∏Îäî #page.textContentÎ°úÎßå ÌëúÏãú(Ïä§ÌÅ¨Î¶∞Î¶¨ÎçîÎ•º ÏúÑÌï¥ 'ÌòÑÏû¨ ÌéòÏù¥ÏßÄ n' ÎùºÎ≤®ÎßÅ Í∂åÏû•).
     - ÌÇ§Î≥¥Îìú Ï†ëÍ∑ºÏÑ±: Ï¢å/Ïö∞ ÌôîÏÇ¥Ìëú ÎòêÎäî PageUp/DownÏùÑ Î≤ÑÌäº ÌÅ¥Î¶≠Í≥º ÎèôÏùºÌïòÍ≤å ÏúÑÏûÑ Í∞ÄÎä•. -->
<div class="pager">
    <button id="prev">Ïù¥Ï†Ñ</button>
    <span id="page"></span>
    <button id="next">Îã§Ïùå</button>
</div>

<!-- ÌïòÎã® Ï¢Ö ÏïÑÏù¥ÏΩò + Îπ®Í∞ÑÏ†ê: /notification/unread-count Í≤∞Í≥ºÎ°ú on/off -->
<!-- [Î∞∞ÏßÄ ÌëúÍ∏∞ Î©îÎ™®]
     - Ï¥àÍ∏∞ ÏßÑÏûÖ Ïãú /notification/unread-count 1Ìöå ÏöîÏ≤≠ÏúºÎ°ú ÌëúÏãú/Ïà®ÍπÄ Í≤∞Ï†ï.
     - Ïù¥ÌõÑ Ìè¥ÎßÅ(Ïòà: 15s)ÏùÄ /js/notification.jsÏóêÏÑúÎßå ÏàòÌñâ(Ï§ëÎ≥µ Ìè¥ÎßÅ Î∞©ÏßÄ).
     - ÏÑúÎ≤ÑÍ∞Ä 0ÏùÑ Î∞òÌôòÌïòÎ©¥ #bell-dot.style.display='none', ÏñëÏàòÎ©¥ '' ÏúºÎ°ú ÎÖ∏Ï∂ú. -->
<div id="nav-bell">üîî<span class="badge" id="bell-dot" style="display:none"></span></div>

<!-- ÌéòÏù¥ÏßÄ Ïä§ÌÅ¨Î¶ΩÌä∏: Î™©Î°ù Î°úÎî©/ÏùΩÏùå Ï≤òÎ¶¨/Î±ÉÏßÄ Í∞±Ïã† ÏàòÌñâ -->
<script src="/js/notification.js"></script>
</body>
</html>
